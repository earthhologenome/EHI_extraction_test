[["index.html", "Earth Hologenome Initiative | Lauritsen et al. 2024 Robust, open-source, and automation-friendly DNA extraction protocol for hologenomic research 1 Introduction 1.1 Prepare the R environment", " Earth Hologenome Initiative | Lauritsen et al. 2024 Robust, open-source, and automation-friendly DNA extraction protocol for hologenomic research Jonas G. Laurisen, Christian Carøe, Nanna Gaun, Garazi Martin, Aoife Leonard, Raphael Eisenhofer, M Thomas P Gilbert, Ostaizka Aizpurua, Antton Alberdi1, Carlotta Pietroni 2025-04-23 1 Introduction This webbook contains all the code used for the comparative study on the generation of metagenomic data from faeces of various species using three extraction methods. 1.1 Prepare the R environment 1.1.1 Environment To reproduce all the analyses locally, clone this repository in your computer using: RStudio &gt; New Project &gt; Version Control &gt; Git And indicating the following git repository: https://github.com/earthhologenome/EHI_extraction_test.git Once the R project has been created, follow the instructions and code chunks shown in this webbook. 1.1.2 Libraries The following R packages are required for the data analysis. # Base library(R.utils) library(knitr) library(tidyverse) library(rairtable) library(devtools) library(tinytable) library(broom) library(broom.mixed) # For tree handling library(ape) library(phyloseq) library(phytools) # For plotting library(ggplot2) library(ggrepel) library(ggpubr) library(ggnewscale) library(gridExtra) library(ggtreeExtra) library(ggtree) library(ggh4x) # For statistics library(spaa) library(vegan) library(Rtsne) library(geiger) library(hilldiv2) library(distillR) library(ANCOMBC) library(lme4) library(MuMIn) library(sjPlot) library(ggeffects) 1.1.3 Color codes vertebrate_colors &lt;- c(`Calotriton asper`=&quot;#157a73&quot;, `Lissotriton helveticus`=&quot;#47bfb6&quot;, `Salamandra atra`=&quot;#92d4d1&quot;, `Chalcides striatus`=&quot;#4a7015&quot;, `Natrix astreptophora`=&quot;#7ea845&quot;, `Podarcis muralis`=&quot;#b9d98d&quot;, `Plecotus auritus`=&quot;#5e1717&quot;, `Sciurus carolinensis`=&quot;#aa3333&quot;, `Trichosurus vulpecula`=&quot;#bf7777&quot;, `Geospizopsis unicolor`=&quot;#9e6b24&quot;, `Perisoreus infaustus`=&quot;#dba55a&quot;, `Zonotrichia capensis`=&quot;#dbbd93&quot;, `Extraction control`=&quot;#7a7a7a&quot;, `Library control`=&quot;#4a4a4a&quot;) University of Copenhagen, antton.alberdi@sund.ku.dk↩︎ "],["laboratory-performance.html", "2 Laboratory performance 2.1 Load data 2.2 DNA yield 2.3 Sample purity 2.4 Sample purity A260/A280 Ratios 2.5 Sample purity A260/A230 Ratios 2.6 Amplification performance", " 2 Laboratory performance 2.1 Load data Load data previously compiled from the database: all_data &lt;- read_tsv(&quot;data/all_data.tsv&quot;) %&gt;% filter(catalogue != &quot;Species&quot;) %&gt;% mutate( Taxon = factor(Taxon, levels = c( &quot;Amphibian&quot;, &quot;Reptile&quot;, &quot;Mammal&quot;, &quot;Bird&quot;, &quot;Control&quot; )), Extraction = case_when( Extraction == &quot;REF&quot; ~ &quot;REF&quot;, Extraction == &quot;DREX&quot; ~ &quot;DREX1&quot;, Extraction == &quot;EHEX&quot; ~ &quot;DREX2&quot;, TRUE ~ Extraction # Keep other values unchanged ), Extraction = factor(Extraction, levels = c( &quot;REF&quot;, &quot;DREX1&quot;, &quot;DREX2&quot; )) ) %&gt;% mutate(Species=factor(Species,levels=c(&quot;Calotriton asper&quot;, &quot;Lissotriton helveticus&quot;, &quot;Salamandra atra&quot;, &quot;Chalcides striatus&quot;, &quot;Natrix astreptophora&quot;, &quot;Podarcis muralis&quot;, &quot;Plecotus auritus&quot;, &quot;Sciurus carolinensis&quot;, &quot;Trichosurus vulpecula&quot;, &quot;Geospizopsis unicolor&quot;, &quot;Perisoreus infaustus&quot;, &quot;Zonotrichia capensis&quot;, &quot;Extraction control&quot;, &quot;Library control&quot;))) table(all_data$Sample) AAQ18 AAZ65 ABA95 ABD27 ABE10 ACB56 ACB61 AEC23 AEC24 3 3 3 3 3 3 3 3 3 AFO83 AFV18 AFV20 AGI41 AGI42 AGI58 AGI59 AGO69 AGZ59 3 3 3 3 3 3 3 3 3 AHU97 AHW91 AHW95 AIV55 AJP51 AJP52 C1_EXB0076 C1_LIB0072 C2_EXB0076 3 3 3 3 3 3 3 1 3 C2_LIB0072 1 2.2 DNA yield Total amount of DNA extracted from the 150 ul subset of the bead-beaten sample. all_data %&gt;% select(Extraction,extract,Taxon) %&gt;% group_by(Taxon,Extraction) %&gt;% summarise(value = sprintf(&quot;%.0f±%.0f&quot;, mean(extract), sd(extract))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of total DNA nanograms&quot;) .table td.tinytable_css_iddih4o7c8k010ppnbvq5n, .table th.tinytable_css_iddih4o7c8k010ppnbvq5n { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of total DNA nanograms Taxon DREX1 DREX2 NA Amphibian 340±475 1138±1195 297±350 Reptile 162±134 250±179 102±71 Mammal 256±224 867±730 448±432 Bird 11±11 44±45 71±134 Control 2±3 1±0 0±0 all_data %&gt;% select(Library,Species,Extraction,extract,Taxon) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction, y=extract, color=Species, group=Extraction))+ geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;DNA yield (ng)&quot;,x=&quot;Extraction method&quot;) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(log(extract) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot() all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(log(extract) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 3.5262 1.1754 3 8 4.9352 0.03158 * Extraction 12.5695 12.5695 1 23 52.7765 2.152e-07 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(log(extract) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% broom.mixed::tidy() %&gt;% tt() .table td.tinytable_css_idadyzn052js53fuu84qdg, .table th.tinytable_css_idadyzn052js53fuu84qdg { border-bottom: solid 0.1em #d3d8dc; } effect group term estimate std.error statistic df p.value fixed NA (Intercept) 5.2327210 0.6641863 7.8783934 8.182676 4.298621e-05 fixed NA TaxonReptile -1.0049348 0.9340039 -1.0759428 8.000001 3.133273e-01 fixed NA TaxonMammal -0.1230476 0.9340039 -0.1317421 8.000001 8.984413e-01 fixed NA TaxonBird -3.1705265 0.9340039 -3.3945538 8.000001 9.436167e-03 fixed NA ExtractionDREX2 1.0234561 0.1408799 7.2647427 23.000000 2.151978e-07 ran_pars Sample:Species sd__(Intercept) 0.9629906 NA NA NA NA ran_pars Species sd__(Intercept) 0.8861874 NA NA NA NA ran_pars Residual sd__Observation 0.4880222 NA NA NA NA all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(log(extract) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot_model(.,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;),show.data = TRUE) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(log(extract) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% ggpredict(.,terms=&quot;Extraction&quot;) # Predicted values of extract Extraction | Predicted | 95% CI ---------------------------------------- DREX1 | 187.30 | 48.93, 717.01 DREX2 | 521.22 | 136.16, 1995.30 Adjusted for: * Taxon = Amphibian * Sample = 0 (population-level) * Species = 0 (population-level) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(log(extract) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% ggpredict(.,terms=&quot;Taxon&quot;) # Predicted values of extract Taxon | Predicted | 95% CI ------------------------------------- Amphibian | 187.30 | 48.93, 717.01 Reptile | 68.57 | 17.91, 262.48 Mammal | 165.62 | 43.26, 634.00 Bird | 7.86 | 2.05, 30.10 Adjusted for: * Extraction = DREX1 * Sample = 0 (population-level) * Species = 0 (population-level) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(log(extract) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot_model(.,type=&quot;pred&quot;,terms=c(&quot;Species&quot;),pred.type = &quot;re&quot;,ci.lvl = NA)+ theme(axis.text.x = element_text(angle = 45, hjust = 1)) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(log(extract) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.4955313 0.9384128 2.3 Sample purity In common laboratory practice, DNA and RNA samples with A260/A280 and A260/A230 &gt; 1.8 are considered to be “clean”, and suitable for use in most downstream applications 2.4 Sample purity A260/A280 Ratios 260 nm and 280 nm are the absorbance wavelengths used to assess the type of nucleic acid present (DNA or RNA) and they provide a rough indication of purity. A reduction of this ratio typically indicates protein contamination while RNA contamination can be detected by an increase of this ratio. The generally accepted 260/280 values are ~1.8 for pure DNA and ~2.0 for RNA. Lower values may indicate the presence of protein, phenol or other contaminants that have an absorbance close to 280 nm. all_data %&gt;% filter(!is.na(x260_280)) %&gt;% select(Extraction, x260_280, Taxon) %&gt;% group_by(Extraction) %&gt;% #group_by(Taxon, Extraction) %&gt;% summarise(value = sprintf(&quot;%.2f±%.2f&quot;, mean(x260_280), sd(x260_280))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of 260/280 values&quot;) .table td.tinytable_css_idmnxcx7vybfqqf9zuj886, .table th.tinytable_css_idmnxcx7vybfqqf9zuj886 { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of 260/280 values DREX1 DREX2 NA 1.63±0.35 1.44±0.31 1.35±0.18 all_data %&gt;% filter(!is.na(x260_280)) %&gt;% mutate(d260_280=abs(1.8-x260_280)) %&gt;% select(Extraction, d260_280, Taxon) %&gt;% group_by(Taxon, Extraction) %&gt;% summarise(value = sprintf(&quot;%.2f±%.2f&quot;, mean(d260_280), sd(d260_280))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of the deviation of 260/280 values from 1.8&quot;) .table td.tinytable_css_idnsfsnmvd2ho85zb361j6, .table th.tinytable_css_idnsfsnmvd2ho85zb361j6 { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of the deviation of 260/280 values from 1.8 Taxon DREX1 DREX2 NA Amphibian 0.33±0.13 0.24±0.14 0.57±0.15 Reptile 0.25±0.16 0.25±0.11 0.40±0.22 Mammal 0.23±0.21 0.43±0.22 0.53±0.12 Bird 0.46±0.24 0.68±0.33 0.35±0.12 Control 0.52±0.16 0.15±0.12 0.33±0.28 Higher deviation from 1.8 indicates lower purity of the DNA extracts all_data %&gt;% select(Extraction, x260_280, Taxon, Species) %&gt;% ggplot(aes(x=Extraction, y=x260_280, color=Species, group=Extraction))+ geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;260/280 values&quot;,x=&quot;Extraction method&quot;) all_data %&gt;% filter(!is.na(x260_280),Taxon != &quot;Control&quot;) %&gt;% #filter(!is.na(x260_280),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_280=abs(1.8-x260_280)) %&gt;% lmerTest::lmer(rank(d260_280) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot() all_data %&gt;% filter(!is.na(x260_280),Taxon != &quot;Control&quot;) %&gt;% #filter(!is.na(x260_280),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_280=abs(1.8-x260_280)) %&gt;% lmerTest::lmer(rank(d260_280) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 2246.20 748.73 3 7.521 3.0502 0.09627 . Extraction 259.48 259.48 1 32.961 1.0571 0.31137 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 all_data %&gt;% filter(!is.na(x260_280),Taxon != &quot;Control&quot;) %&gt;% #filter(!is.na(x260_280),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_280=abs(1.8-x260_280)) %&gt;% lmerTest::lmer(rank(d260_280) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% broom.mixed::tidy() %&gt;% tt() .table td.tinytable_css_id3db53gcsl5u23ozynz98, .table th.tinytable_css_id3db53gcsl5u23ozynz98 { border-bottom: solid 0.1em #d3d8dc; } effect group term estimate std.error statistic df p.value fixed NA (Intercept) 22.948293 6.609183 3.4721830 9.324975 0.00665822 fixed NA TaxonReptile -5.333333 8.752143 -0.6093745 7.174230 0.56107126 fixed NA TaxonMammal 1.598556 8.870449 0.1802114 7.531076 0.86174079 fixed NA TaxonBird 19.975062 8.870449 2.2518660 7.531076 0.05641902 fixed NA ExtractionDREX2 4.770080 4.639524 1.0281400 32.961101 0.31137015 ran_pars Sample:Species sd__(Intercept) 0.000000 NA NA NA NA ran_pars Species sd__(Intercept) 7.316513 NA NA NA NA ran_pars Residual sd__Observation 15.667629 NA NA NA NA all_data %&gt;% filter(!is.na(x260_280),Taxon != &quot;Control&quot;) %&gt;% #filter(!is.na(x260_280),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_280=abs(1.8-x260_280)) %&gt;% lmerTest::lmer(rank(d260_280) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot_model(.,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;)) all_data %&gt;% filter(!is.na(x260_280),Taxon != &quot;Control&quot;) %&gt;% #filter(!is.na(x260_280),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_280=abs(1.8-x260_280)) %&gt;% lmerTest::lmer(rank(d260_280) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% ggpredict(.,terms=&quot;Extraction&quot;) # Predicted values of d260_280 Extraction | Predicted | 95% CI ------------------------------------- DREX1 | 22.95 | 9.57, 36.33 DREX2 | 27.72 | 14.34, 41.10 Adjusted for: * Taxon = Amphibian * Sample = 0 (population-level) * Species = 0 (population-level) all_data %&gt;% filter(!is.na(x260_280),Taxon != &quot;Control&quot;) %&gt;% mutate(d260_280=abs(1.8-x260_280)) %&gt;% lmerTest::lmer(rank(d260_280) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.2487332 0.3832333 2.5 Sample purity A260/A230 Ratios The A260/A230 is a sensitive indicator of contaminants that absorb at 230 nm. These contaminants are significantly more numerous than those absorbing at 280 nm, and include chaotropic salts such as guanidine thiocyanate (GTC) and guanidine hydrochloride (GuHCl), EDTA, non-ionic detergents like Triton™ X-100 and Tween® 20, proteins, and phenol. Substances like polysaccharides or free floating solid particles like silica fibers absorb at this wavelength, but will have a weaker effect. Low 260/230 values indicates the presence of residual extraction reagent (ex. Carbohydrates, Chaotropic salts, phenol). all_data %&gt;% filter(!is.na(x260_230)) %&gt;% select(Extraction, x260_230, Taxon) %&gt;% group_by(Extraction) %&gt;% #group_by(Taxon, Extraction) %&gt;% summarise(value = sprintf(&quot;%.2f±%.2f&quot;, mean(x260_230), sd(x260_230))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of 260/230 values&quot;) .table td.tinytable_css_idxdgvmuy2h0mftov2jta5, .table th.tinytable_css_idxdgvmuy2h0mftov2jta5 { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of 260/230 values DREX1 DREX2 NA 0.17±0.13 0.20±0.27 0.09±0.11 all_data %&gt;% filter(!is.na(x260_230)) %&gt;% mutate(d260_230=abs(1.8-x260_230)) %&gt;% select(Extraction, d260_230, Taxon) %&gt;% group_by(Taxon, Extraction) %&gt;% summarise(value = sprintf(&quot;%.2f±%.2f&quot;, mean(d260_230), sd(d260_230))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of the deviation of 260/230 values from 1.8&quot;) .table td.tinytable_css_idkon7rbsnuah8oop13qic, .table th.tinytable_css_idkon7rbsnuah8oop13qic { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of the deviation of 260/230 values from 1.8 Taxon DREX1 DREX2 NA Amphibian 1.53±0.15 1.61±0.17 1.72±0.09 Reptile 1.66±0.13 1.63±0.17 1.76±0.04 Mammal 1.63±0.12 1.38±0.52 1.62±0.17 Bird 1.69±0.10 1.67±0.10 1.72±0.09 Control 1.72±0.09 1.79±0.00 1.79±0.00 Higher deviation from 1.8 indicates lower purity of the DNA extracts all_data %&gt;% filter(!is.na(x260_230)) %&gt;% select(Extraction, x260_230, Taxon, Species) %&gt;% ggplot(aes(x=Extraction, y=x260_230, color=Species, group=Extraction))+ geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Deviation of 260/230 values from 1.8&quot;,x=&quot;Extraction method&quot;) all_data %&gt;% # filter(!is.na(x260_230),Taxon != &quot;Control&quot;) %&gt;% filter(!is.na(x260_230),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_230=abs(1.8-x260_230)) %&gt;% lmerTest::lmer(rank(d260_230) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot() all_data %&gt;% # filter(!is.na(x260_230),Taxon != &quot;Control&quot;) %&gt;% filter(!is.na(x260_230),Taxon != &quot;Control&quot;,!dna_extract %in% c(&quot;AGI41E1&quot;)) %&gt;% #filter(!is.na(x260_230),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_230=abs(1.8-x260_230)) %&gt;% lmerTest::lmer(rank(d260_230) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 340.72 113.573 3 7.8351 0.8686 0.4969 Extraction 73.56 73.563 1 21.4355 0.5626 0.4614 all_data %&gt;% # filter(!is.na(x260_230),Taxon != &quot;Control&quot;) %&gt;% filter(!is.na(x260_230),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_230=abs(1.8-x260_230)) %&gt;% lmerTest::lmer(rank(d260_230) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% broom.mixed::tidy() %&gt;% tt() .table td.tinytable_css_idz3xpr71vwburiwcl0ih3, .table th.tinytable_css_idz3xpr71vwburiwcl0ih3 { border-bottom: solid 0.1em #d3d8dc; } effect group term estimate std.error statistic df p.value fixed NA (Intercept) 22.166667 6.477900 3.4218909 15.54473 0.003620386 fixed NA TaxonReptile 6.950000 8.461282 0.8213885 14.00000 0.425192167 fixed NA TaxonMammal -4.500000 8.461282 -0.5318343 14.00000 0.603178442 fixed NA TaxonBird 11.437500 8.918974 1.2823784 14.00000 0.220537407 fixed NA ExtractionDREX2 -3.333333 2.959144 -1.1264517 17.00000 0.275624994 ran_pars Sample:Species sd__(Intercept) 10.940375 NA NA NA NA ran_pars Species sd__(Intercept) 0.000000 NA NA NA NA ran_pars Residual sd__Observation 8.877433 NA NA NA NA all_data %&gt;% # filter(!is.na(x260_230),Taxon != &quot;Control&quot;) %&gt;% filter(!is.na(x260_230),Taxon != &quot;Control&quot;, !Sample %in% c(&quot;ABD27&quot;, &quot;AJP51&quot;, &quot;AFO83&quot;,&quot;AAZ65&quot;,&quot;AGI41&quot;, &quot;AIV55&quot;)) %&gt;% mutate(d260_230=abs(1.8-x260_230)) %&gt;% lmerTest::lmer(rank(d260_230) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot_model(.,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;),show.data = TRUE) all_data %&gt;% filter(!is.na(x260_230),Taxon != &quot;Control&quot;) %&gt;% mutate(d260_230=abs(1.8-x260_230)) %&gt;% lmerTest::lmer(rank(d260_230) ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.09655789 0.6151747 2.6 Amplification performance all_data %&gt;% filter(!is.na(ct_d_rn)) %&gt;% select(Extraction, ct_d_rn, Taxon) %&gt;% group_by(Taxon, Extraction) %&gt;% summarise(value = sprintf(&quot;%.2f±%.2f&quot;, mean(ct_d_rn), sd(ct_d_rn))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of Cts (cycle threshold) values&quot;) .table td.tinytable_css_idld3zfbqicv9otq8sx3l7, .table th.tinytable_css_idld3zfbqicv9otq8sx3l7 { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of Cts (cycle threshold) values Taxon DREX1 DREX2 NA Amphibian 15.57±3.29 14.42±2.53 18.19±2.11 Reptile 14.56±3.36 16.33±3.37 16.16±3.91 Mammal 14.75±1.84 14.45±2.06 15.21±4.13 Bird 20.83±2.31 18.91±2.51 20.36±3.58 Control 23.39±0.76 26.23±4.24 23.86±2.69 all_data %&gt;% #filter(!Taxon==&quot;Control&quot;) %&gt;% select(Library,Species,Extraction, ct_d_rn,Taxon) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction, y=ct_d_rn, color=Species, group=Extraction))+ geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Cts (cycle threshold) values&quot;,x=&quot;Extraction method&quot;) all_data %&gt;% select(dna_extract, ct_d_rn, ng_ul_lib, Species, Extraction) %&gt;% ggplot(aes(x=log10(ng_ul_lib), y=ct_d_rn)) + geom_point(aes(color=Extraction)) + geom_smooth(method = &quot;lm&quot;, se=FALSE) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(ct_d_rn ~ Taxon + Extraction + log10(ng_ul_lib) + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot() all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(ct_d_rn ~ Taxon + Extraction + log10(ng_ul_lib) + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 13.4590 4.4863 3 9.1491 1.1356 0.38500 Extraction 0.0305 0.0305 1 27.4249 0.0077 0.93067 log10(ng_ul_lib) 19.7002 19.7002 1 25.6867 4.9865 0.03448 * --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(ct_d_rn ~ Taxon + Extraction + log10(ng_ul_lib) + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% broom.mixed::tidy() %&gt;% tt() .table td.tinytable_css_idqf212ojyxk6jzwnv0758, .table th.tinytable_css_idqf212ojyxk6jzwnv0758 { border-bottom: solid 0.1em #d3d8dc; } effect group term estimate std.error statistic df p.value fixed NA (Intercept) 15.41972940 1.0178964 15.14862404 9.291829 7.296296e-08 fixed NA TaxonReptile -0.02524639 1.3900401 -0.01816235 8.014105 9.859534e-01 fixed NA TaxonMammal -0.38376545 1.3735432 -0.27939817 7.799250 7.872051e-01 fixed NA TaxonBird 2.56408412 1.7208783 1.48998570 12.127517 1.617699e-01 fixed NA ExtractionDREX2 0.05339490 0.6081497 0.08779894 27.424871 9.306745e-01 fixed NA log10(ng_ul_lib) -1.98698972 0.8898107 -2.23304770 25.686666 3.448060e-02 ran_pars Sample:Species sd__(Intercept) 1.46786649 NA NA NA NA ran_pars Species sd__(Intercept) 0.87458948 NA NA NA NA ran_pars Residual sd__Observation 1.98763790 NA NA NA NA all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(ct_d_rn ~ Taxon + Extraction + log10(ng_ul_lib) + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot_model(.,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;),show.data = TRUE) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% mutate(&quot;log_extract&quot;=log(extract))%&gt;% lmerTest::lmer(ct_d_rn ~ Taxon + Extraction + log10(ng_ul_lib) + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% ggeffects::ggpredict(.,terms=&quot;Extraction&quot;) # Predicted values of ct_d_rn Extraction | Predicted | 95% CI ------------------------------------- DREX1 | 14.90 | 12.83, 16.96 DREX2 | 14.95 | 12.90, 17.00 Adjusted for: * Taxon = Amphibian * ng_ul_lib = 1.84 * Sample = 0 (population-level) * Species = 0 (population-level) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(ct_d_rn ~ Taxon + Extraction + log10(ng_ul_lib) + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.4486514 0.6829493 "],["sequencing-data.html", "3 Sequencing data 3.1 Sequencing depth 3.2 Quality-filtering", " 3 Sequencing data 3.1 Sequencing depth tibble(metric=c(&quot;Total GB&quot;, &quot;Total reads&quot;, &quot;Average GB&quot;, &quot;Average reads&quot;), value=unlist(c(round(all_data %&gt;% summarise(sum(bases_pre_fastp)) / 1000000000,2), round(all_data %&gt;% summarise(sum(bases_pre_fastp)) / 300,2), paste0(round(all_data %&gt;% summarise(mean(bases_pre_fastp)) / 1000000000,2),&quot;±&quot;,round(all_data %&gt;% summarise(sd(bases_pre_fastp)) / 1000000000,2)), paste0(round(all_data %&gt;% summarise(mean(bases_pre_fastp)) / 300,0),&quot;±&quot;,round(all_data %&gt;% summarise(sd(bases_pre_fastp)) / 300,0)))) ) %&gt;% tt() .table td.tinytable_css_id8pl6qyhjsn3q55pso8eq, .table th.tinytable_css_id8pl6qyhjsn3q55pso8eq { border-bottom: solid 0.1em #d3d8dc; } metric value Total GB 429.1 Total reads 1430317433 Average GB 5.36±2.7 Average reads 17878968±9011624 all_data %&gt;% group_by(Taxon,Extraction) %&gt;% summarise(value = sprintf(&quot;%.1f±%.1f&quot;, mean(bases_post_fastp / 1000000000), sd(bases_post_fastp / 1000000000))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of sequencing depth (GB)&quot;) .table td.tinytable_css_id3p9cy8e55c0jasf0huow, .table th.tinytable_css_id3p9cy8e55c0jasf0huow { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of sequencing depth (GB) Taxon DREX1 DREX2 NA Amphibian 4.2±2.3 4.7±0.4 4.0±1.5 Reptile 5.7±1.4 5.0±1.9 6.1±2.3 Mammal 4.6±2.2 3.8±2.5 5.5±3.3 Bird 3.4±2.5 2.7±1.9 3.7±1.9 Control 0.5±0.6 2.1±2.7 0.0±0.0 all_data %&gt;% select(Library,Species,Extraction,bases_pre_fastp,Taxon) %&gt;% mutate(bases_pre_fastp=bases_pre_fastp/1000000000) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction,y=bases_pre_fastp, color=Species, group=Extraction)) + geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Sequencing depth (Gb)&quot;,x=&quot;Extraction method&quot;) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(bases_post_fastp ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot() all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(bases_post_fastp ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 1.6247e+19 5.4155e+18 3 2.0000e+01 2.0405 0.1405 Extraction 1.9154e+18 1.9154e+18 1 7.3265e+21 0.7217 0.3956 all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(bases_post_fastp ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% broom.mixed::tidy() %&gt;% tt() .table td.tinytable_css_idlyevdxqgbwb0cc481l7o, .table th.tinytable_css_idlyevdxqgbwb0cc481l7o { border-bottom: solid 0.1em #d3d8dc; } effect group term estimate std.error statistic df p.value fixed NA (Intercept) 4618302181 693338098 6.6609670 2.553672e+01 5.011617e-07 fixed NA TaxonReptile 923459464 922414784 1.0011325 1.999999e+01 3.287222e-01 fixed NA TaxonMammal -222147455 922414784 -0.2408325 1.999999e+01 8.121366e-01 fixed NA TaxonBird -1343573234 922414784 -1.4565825 1.999999e+01 1.607528e-01 fixed NA ExtractionDREX2 -399522878 470290127 -0.8495243 7.326468e+21 3.955896e-01 ran_pars Sample:Species sd__(Intercept) 1107027679 NA NA NA NA ran_pars Species sd__(Intercept) 0 NA NA NA NA ran_pars Residual sd__Observation 1629132788 NA NA NA NA all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(bases_post_fastp ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot_model(.,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;)) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(bases_post_fastp ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot_model(.,type=&quot;pred&quot;,terms=c(&quot;Species&quot;),pred.type = &quot;re&quot;,ci.lvl = NA)+ theme(axis.text.x = element_text(angle = 45, hjust = 1)) all_data %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(bases_post_fastp ~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.1538968 0.4211699 3.2 Quality-filtering all_data %&gt;% mutate(qf_bases=bases_post_fastp/bases_pre_fastp*100) %&gt;% group_by(Taxon,Extraction) %&gt;% summarise(value = sprintf(&quot;%.1f±%.1f&quot;, mean(qf_bases), sd(qf_bases))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of quality-filtered proportion of reads&quot;) .table td.tinytable_css_idd0nxdxtprss1pexq8tjq, .table th.tinytable_css_idd0nxdxtprss1pexq8tjq { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of quality-filtered proportion of reads Taxon DREX1 DREX2 NA Amphibian 91.1±4.8 87.5±4.0 84.6±1.5 Reptile 90.5±7.4 88.3±7.6 89.9±6.6 Mammal 89.0±5.1 91.3±1.8 92.2±2.4 Bird 62.5±29.3 66.7±19.3 70.6±16.5 Control 9.8±11.5 27.5±3.4 3.3±2.3 all_data %&gt;% mutate(qf_bases=bases_post_fastp/bases_pre_fastp*100) %&gt;% select(Library,Species,Extraction,qf_bases,Taxon) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction,y=qf_bases, color=Species, group=Extraction)) + geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;High-quality data (%)&quot;,x=&quot;Extraction method&quot;) data&lt;-all_data %&gt;% mutate(qf_bases=bases_post_fastp/bases_pre_fastp,unique_sample=factor(1:nrow(all_data))) %&gt;% filter(Taxon != &quot;Control&quot;) M &lt;-MASS::glmmPQL(qf_bases~ Taxon+Extraction,random=~1|Species/Sample, family=&quot;quasibinomial&quot;,data=data) Anova_table&lt;-car::Anova(M,test.statistic=&quot;Wald&quot;,type=&quot;III&quot;)%&gt;% mutate(F=Chisq/Df) # Approximate F value n &lt;- nrow(M$data) # Total number of observations df_fixed &lt;- length(fixef(M)) # Number of fixed effect parameters df_random &lt;- length(ranef(M)) # Number of random effect parameters (or levels) approx_residual_df &lt;- n - df_fixed - df_random # Approx. residual Df data.frame(Anova_table, p_value=pf(Anova_table$F, Anova_table$Df, approx_residual_df, lower.tail = FALSE))%&gt;% select(F,p_value) F p_value (Intercept) 57.54921211 2.482871e-09 Taxon 9.60948040 6.268692e-05 Extraction 0.01221157 9.125473e-01 broom.mixed::tidy(M) %&gt;% tt() .table td.tinytable_css_ide3l9on5afvbyd7xdgsz8, .table th.tinytable_css_ide3l9on5afvbyd7xdgsz8 { border-bottom: solid 0.1em #d3d8dc; } effect term estimate std.error df statistic p.value fixed (Intercept) 2.13482382 0.2973232 23 7.1801464 2.602704e-07 fixed TaxonReptile 0.01325717 0.4056935 8 0.0326778 9.747321e-01 fixed TaxonMammal 0.08084973 0.4076898 8 0.1983119 8.477478e-01 fixed TaxonBird -1.51089938 0.3830025 8 -3.9448817 4.266553e-03 fixed ExtractionDREX2 0.01671214 0.1597838 23 0.1045922 9.176062e-01 plot_model(M,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;)) "],["genomic-data.html", "4 Genomic data 4.1 Read duplicates 4.2 Depth of coverage 4.3 Breadth of coverage 4.4 Breadth vs. coverage", " 4 Genomic data 4.1 Read duplicates all_data %&gt;% select(dataset,Extraction,duplicates,Taxon) %&gt;% unique() %&gt;% group_by(Taxon,Extraction) %&gt;% summarise(value = sprintf(&quot;%.1f±%.1f&quot;, mean(duplicates), sd(duplicates))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of fraction of duplicated reads&quot;) .table td.tinytable_css_id1q9v4h8lsbe64muoaklo, .table th.tinytable_css_id1q9v4h8lsbe64muoaklo { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of fraction of duplicated reads Taxon DREX1 DREX2 NA Amphibian 0.2±0.2 0.2±0.2 0.3±0.2 Reptile 0.3±0.3 0.4±0.4 0.5±0.4 Mammal 0.2±0.1 0.2±0.2 0.4±0.4 Bird 0.9±0.1 0.6±0.4 0.8±0.3 Control 0.9±0.0 1.0±0.0 1.0±0.0 all_data %&gt;% select(dataset,Extraction,duplicates,Taxon, Species) %&gt;% mutate(duplicates=duplicates*100) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction,y=duplicates, color=Species, group=Extraction)) + scale_y_reverse() + geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Duplication rate (%)&quot;,x=&quot;Extraction method&quot;) data&lt;-all_data %&gt;% select(dataset,Sample,Species,Extraction,duplicates,Taxon,catalogue) %&gt;% filter(Taxon != &quot;Control&quot;) M&lt;-MASS::glmmPQL(duplicates~ Taxon+Extraction,random=~1|Species/Sample, family=&quot;quasibinomial&quot;,data=data) Anova_table&lt;-car::Anova(M,test.statistic=&quot;Wald&quot;,type=&quot;III&quot;)%&gt;% mutate(F=Chisq/Df) # Approximate F value n &lt;- nrow(M$data) # Total number of observations df_fixed &lt;- length(fixef(M)) # Number of fixed effect parameters df_random &lt;- length(ranef(M)) # Number of random effect parameters (or levels) approx_residual_df &lt;- n - df_fixed - df_random # Approx. residual Df data.frame(Anova_table, p_value=pf(Anova_table$F, Anova_table$Df, approx_residual_df, lower.tail = FALSE))%&gt;% select(F,p_value) F p_value (Intercept) 7.375715 0.0096337381 Taxon 6.858250 0.0007522155 Extraction 1.912610 0.1741595452 broom.mixed::tidy(M) %&gt;% tt() .table td.tinytable_css_idot547mz183z5rzk620fq, .table th.tinytable_css_idot547mz183z5rzk620fq { border-bottom: solid 0.1em #d3d8dc; } effect term estimate std.error df statistic p.value fixed (Intercept) -1.35324426 0.5264541 23 -2.57048855 0.017100895 fixed TaxonReptile 0.92179496 0.6953554 8 1.32564586 0.221559716 fixed TaxonMammal 0.06212247 0.7139576 8 0.08701143 0.932800914 fixed TaxonBird 2.62984727 0.7066673 8 3.72147844 0.005858951 fixed ExtractionDREX2 -0.38038452 0.2906003 23 -1.30896118 0.203475506 plot_model(M,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;)) 4.2 Depth of coverage all_data %&gt;% select(dataset,Extraction,coverage_depth,Taxon) %&gt;% unique() %&gt;% group_by(Taxon,Extraction) %&gt;% summarise(value = sprintf(&quot;%.1f±%.1f&quot;, mean(coverage_depth), sd(coverage_depth))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of fraction of duplicated reads&quot;) .table td.tinytable_css_idf0xpb34b6c24v3x2rp3x, .table th.tinytable_css_idf0xpb34b6c24v3x2rp3x { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of fraction of duplicated reads Taxon DREX1 DREX2 NA Amphibian 0.0±0.0 0.0±0.0 0.0±0.0 Reptile 0.1±0.1 0.1±0.1 0.2±0.3 Mammal 0.3±0.4 0.5±1.0 0.7±1.2 Bird 0.6±0.5 0.8±0.8 0.4±0.8 Control 0.0±0.0 0.0±0.0 0.0±0.0 all_data %&gt;% select(dataset,Extraction,coverage_depth,Taxon, Species) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction,y=coverage_depth, color=Species, group=Extraction)) + geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Depth of coverage&quot;,x=&quot;Extraction method&quot;) all_data %&gt;% select(dataset,Sample,Species,Extraction,coverage_depth,Taxon,catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(rank(coverage_depth)~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot() all_data %&gt;% select(dataset,Sample,Species,Extraction,coverage_depth,Taxon,catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(rank(coverage_depth)~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 1345.62 448.54 3 7.9991 5.9822 0.0193 * Extraction 0.13 0.13 1 22.9991 0.0017 0.9671 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 all_data %&gt;% select(dataset,Sample,Species,Extraction,coverage_depth,Taxon,catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(rank(coverage_depth)~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% plot_model(.,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;)) all_data %&gt;% select(dataset,Sample,Species,Extraction,coverage_depth,Taxon,catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(rank(coverage_depth)~ Taxon + Extraction + (1 | Species/Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.5214575 0.8467792 4.3 Breadth of coverage all_data %&gt;% select(dataset,Extraction,coverage_breadth,Taxon) %&gt;% unique() %&gt;% group_by(Taxon,Extraction) %&gt;% summarise(value = sprintf(&quot;%.1f±%.1f&quot;, mean(coverage_breadth), sd(coverage_breadth))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of depth of host genome coverage&quot;) .table td.tinytable_css_idmdrptkrxm3iv6iqoqnx5, .table th.tinytable_css_idmdrptkrxm3iv6iqoqnx5 { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of depth of host genome coverage Taxon DREX1 DREX2 NA Amphibian 0.0±0.0 0.0±0.0 0.0±0.0 Reptile 3.0±5.4 2.9±3.7 4.9±7.5 Mammal 10.2±16.4 15.1±26.4 5.7±5.9 Bird 3.2±4.4 8.9±13.9 0.6±0.5 Control 0.0±0.0 0.0±0.0 0.0±0.0 all_data %&gt;% select(dataset,Extraction,coverage_breadth,Taxon,Species) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction,y=coverage_breadth, color=Species, group=Extraction)) + geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Breadth of coverage (%)&quot;,x=&quot;Extraction method&quot;) data&lt;-all_data %&gt;% select(dataset,Extraction,Sample,Species,coverage_breadth,Taxon,catalogue) %&gt;% ## Since amphibians contain only 0s, the small constant value avoid extremely large confidence intervals for that group mutate(coverage_breadth=(coverage_breadth/100)+0.001)%&gt;% filter(Taxon != &quot;Control&quot;) # %&gt;%filter(catalogue != &quot;All&quot;) M&lt;-MASS::glmmPQL(coverage_breadth~ Taxon+Extraction,random=~1|Species/Sample, family=&quot;quasibinomial&quot;,data=data) Anova_table&lt;-car::Anova(M,test.statistic=&quot;Wald&quot;,type=&quot;III&quot;)%&gt;% mutate(F=Chisq/Df) # Approximate F value n &lt;- nrow(M$data) # Total number of observations df_fixed &lt;- length(fixef(M)) # Number of fixed effect parameters df_random &lt;- length(ranef(M)) # Number of random effect parameters (or levels) approx_residual_df &lt;- n - df_fixed - df_random # Approx. residual Df data.frame(Anova_table, p_value=pf(Anova_table$F, Anova_table$Df, approx_residual_df, lower.tail = FALSE))%&gt;% select(F,p_value) F p_value (Intercept) 26.765848 6.406537e-06 Taxon 2.869847 4.795418e-02 Extraction 10.031429 2.903895e-03 broom.mixed::tidy(M) %&gt;% tt() .table td.tinytable_css_idi83y0tapsgsbsvv28r5w, .table th.tinytable_css_idi83y0tapsgsbsvv28r5w { border-bottom: solid 0.1em #d3d8dc; } effect term estimate std.error df statistic p.value fixed (Intercept) -7.2639987 1.483446 23 -4.896707 6.027117e-05 fixed TaxonReptile 2.7918857 1.644140 8 1.698082 1.279236e-01 fixed TaxonMammal 4.1672413 1.615059 8 2.580240 3.260413e-02 fixed TaxonBird 3.7785401 1.615582 8 2.338810 4.750386e-02 fixed ExtractionDREX2 0.6700985 0.223534 23 2.997747 6.424213e-03 plot_model(M,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;)) 4.4 Breadth vs. coverage all_data_log &lt;- all_data %&gt;% mutate(coverage_breadth_log=log(coverage_breadth)) %&gt;% mutate(coverage_depth_log=log(coverage_depth)) lm_eq &lt;- lm(coverage_breadth_log ~ coverage_depth_log, data = all_data_log %&gt;% filter(coverage_depth_log != -Inf ,coverage_breadth_log != -Inf)) coef &lt;- coef(lm_eq) all_data_log$coverage_breadth_log_pred &lt;- coef[1] + coef[2] * all_data_log$coverage_depth_log all_data_log %&gt;% select(dataset,Extraction,coverage_depth_log,coverage_breadth_log,coverage_breadth_log_pred,Taxon,Species,Sample) %&gt;% unique() %&gt;% ggplot(aes(x=coverage_depth_log,y=coverage_breadth_log)) + geom_point(aes(color=Species, shape=Extraction),size=3, alpha=0.9) + geom_segment(aes(x = coverage_depth_log, y = coverage_breadth_log, xend = coverage_depth_log, yend = coverage_breadth_log_pred, color=Species), alpha=0.9)+ geom_smooth(method = lm, se = FALSE, color=&quot;#666666&quot;) + scale_color_manual(values=vertebrate_colors) + theme_minimal() + labs(y=&quot;Breadth of coverage (%)&quot;,x=&quot;Depth of coverage&quot;) "],["metagenomic-data.html", "5 Metagenomic data 5.1 Library complexity 5.2 Combined community analysis 5.3 Microbial complexity recovery", " 5 Metagenomic data 5.1 Library complexity Nonpareil estimate of the metagenomic complexity after removing host DNA. all_data %&gt;% select(dataset,Extraction,nonpareil,Taxon) %&gt;% unique() %&gt;% group_by(Taxon,Extraction) %&gt;% summarise(value = sprintf(&quot;%.1f±%.1f&quot;, mean(nonpareil), sd(nonpareil))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of breadth of host genome coverage&quot;) .table td.tinytable_css_id7xyeoft8qqp5ls719ehd, .table th.tinytable_css_id7xyeoft8qqp5ls719ehd { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of breadth of host genome coverage Taxon DREX1 DREX2 NA Amphibian 0.8±0.1 0.8±0.1 0.9±0.1 Reptile 0.9±0.0 0.9±0.1 0.9±0.1 Mammal 0.8±0.1 0.7±0.3 0.8±0.2 Bird 1.0±0.0 0.8±0.4 0.9±0.1 Control 0.5±0.6 0.5±0.7 0.0±0.0 all_data %&gt;% select(dataset,Extraction,nonpareil,Taxon,Species) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction,y=nonpareil, color=Species, group=Extraction)) + geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Nonpareil completeness&quot;,x=&quot;Extraction method&quot;) all_data %&gt;% select(dataset,Extraction,Sample,Species,nonpareil,Taxon,catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% #filter(catalogue != &quot;All&quot;) %&gt;% MASS::glmmPQL(nonpareil~ Taxon+Extraction,random=~1|Species/Sample, family=&quot;quasibinomial&quot;,data=.) %&gt;% car::Anova(.,test.statistic=&quot;Wald&quot;) Analysis of Deviance Table (Type II tests) Response: zz Chisq Df Pr(&gt;Chisq) Taxon 6.9492 3 0.0735351 . Extraction 14.4505 1 0.0001439 *** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 data&lt;-all_data %&gt;% select(dataset,Extraction,Sample,Species,nonpareil,Taxon,catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) #%&gt;% filter(catalogue != &quot;All&quot;) M&lt;-MASS::glmmPQL(nonpareil~ Taxon+Extraction,random=~1|Species/Sample, family=&quot;quasibinomial&quot;,data=data) Anova_table&lt;-car::Anova(M,test.statistic=&quot;Wald&quot;,type=&quot;III&quot;)%&gt;% mutate(F=Chisq/Df) # Approximate F value n &lt;- nrow(M$data) # Total number of observations df_fixed &lt;- length(fixef(M)) # Number of fixed effect parameters df_random &lt;- length(ranef(M)) # Number of random effect parameters (or levels) approx_residual_df &lt;- n - df_fixed - df_random # Approx. residual Df data.frame(Anova_table, p_value=pf(Anova_table$F, Anova_table$Df, approx_residual_df, lower.tail = FALSE))%&gt;% select(F,p_value) F p_value (Intercept) 26.009617 8.127075e-06 Taxon 2.316396 8.982669e-02 Extraction 14.450542 4.696521e-04 broom.mixed::tidy(M) %&gt;% tt() .table td.tinytable_css_id2sv3733f1yyzxnzwwh4x, .table th.tinytable_css_id2sv3733f1yyzxnzwwh4x { border-bottom: solid 0.1em #d3d8dc; } effect term estimate std.error df statistic p.value fixed (Intercept) 2.0655060 0.4279035 23 4.8270366 7.166571e-05 fixed TaxonReptile 0.8581992 0.5934866 8 1.4460296 1.861816e-01 fixed TaxonMammal -0.4456258 0.5452883 8 -0.8172298 4.374562e-01 fixed TaxonBird 0.6191035 0.5848621 8 1.0585462 3.207187e-01 fixed ExtractionDREX2 -0.9669404 0.2687473 23 -3.5979546 1.517633e-03 plot_model(M,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;)) VarCorr(M) Variance StdDev Species = pdLogChol(1) (Intercept) 2.550101e-09 5.049852e-05 Sample = pdLogChol(1) (Intercept) 5.151788e-01 7.177596e-01 Residual 8.705916e-02 2.950579e-01 # Within-taxon between-species variance: 0% 4*(2.092129e-09/(2.092129e-09+1.658436e-01)) [1] 5.046029e-08 # Within-species between-sample variance: 4% 4*(1.658436e-01/(2.092129e-09+1.658436e-01)) [1] 4 EHEX obtained lower nonpareil completeness values than REF and DREX. Lowest nonpareil completeness values were ontained for mammals and higest for reptiles. 5.2 Combined community analysis species=&quot;combined&quot; genus=species sample_metadata &lt;- read_tsv(paste0(&quot;data/metadata.tsv&quot;)) %&gt;% rename(dataset=Dataset) read_counts &lt;- read_tsv(&quot;https://sid.erda.dk/share_redirect/BaMZodj9sA/DMB/DMB0134/DMB0134_counts.tsv.gz&quot;) %&gt;% rename(genome = 1) genome_metadata &lt;- read_tsv(&quot;https://sid.erda.dk/share_redirect/BaMZodj9sA/DMB/DMB0134/DMB0134_mag_info.tsv.gz&quot;) %&gt;% rename(genome = 1, length=mag_size) genome_coverage &lt;- read_tsv(&quot;https://sid.erda.dk/share_redirect/BaMZodj9sA/DMB/DMB0134/DMB0134_coverage.tsv.gz&quot;) %&gt;% rename(genome = 1) download.file(&quot;https://sid.erda.dk/share_redirect/BaMZodj9sA/DMB/DMB0134/DMB0134.tree.gz&quot;, &quot;data/DMB0134.tree.gz&quot;) genome_tree &lt;- read_tree(&quot;data/DMB0134.tree.gz&quot;) 5.2.1 Filter data #Filter by coverage min_coverage=0.3 read_counts_filt &lt;- genome_coverage %&gt;% mutate(across(where(is.numeric), ~ ifelse(. &gt; min_coverage, 1, 0))) %&gt;% mutate(across(-1, ~ . * read_counts[[cur_column()]])) # Transform to genome counts (non-filtered) readlength=150 genome_counts &lt;- read_counts %&gt;% mutate(across(where(is.numeric), ~ . / (genome_metadata$length / readlength) )) # Transform to genome counts (coverage-filtered) readlength=150 genome_counts_filt &lt;- read_counts_filt %&gt;% mutate(across(where(is.numeric), ~ . / (genome_metadata$length / readlength) )) 5.2.2 Alpha diversity #Calculate Hill numbers richness &lt;- genome_counts_filt %&gt;% column_to_rownames(var=&quot;genome&quot;) %&gt;% select(where(~!all(. == 0))) %&gt;% hilldiv(.,q=0) %&gt;% t() %&gt;% as.data.frame() %&gt;% rename(richness=1) %&gt;% rownames_to_column(var=&quot;dataset&quot;) neutral &lt;- genome_counts_filt %&gt;% column_to_rownames(var=&quot;genome&quot;) %&gt;% select(where(~!all(. == 0))) %&gt;% hilldiv(.,q=1) %&gt;% t() %&gt;% as.data.frame() %&gt;% rename(neutral=1) %&gt;% rownames_to_column(var=&quot;dataset&quot;) phylogenetic &lt;- genome_counts_filt %&gt;% column_to_rownames(var=&quot;genome&quot;) %&gt;% select(where(~!all(. == 0))) %&gt;% hilldiv(.,q=1,tree=genome_tree) %&gt;% t() %&gt;% as.data.frame() %&gt;% rename(phylogenetic=1) %&gt;% rownames_to_column(var=&quot;dataset&quot;) # Merge alpha diversities alpha_diversity &lt;- richness %&gt;% full_join(neutral,by=join_by(dataset==dataset)) %&gt;% full_join(phylogenetic,by=join_by(dataset==dataset)) # Write alpha diversities #alpha_diversity %&gt;% write_tsv(paste0(&quot;results/alpha_&quot;,genus,&quot;.tsv&quot;)) # Print alpha diversity alpha_diversity %&gt;% left_join(sample_metadata %&gt;% select(dataset, Extraction, Sample), by = join_by(dataset == dataset)) %&gt;% group_by(Extraction) %&gt;% summarise(richness = mean(richness), neutral = mean(neutral), phylogenetic = mean(phylogenetic)) %&gt;% tt() .table td.tinytable_css_idd7tzzmw6drxdpk1mdu2m, .table th.tinytable_css_idd7tzzmw6drxdpk1mdu2m { border-bottom: solid 0.1em #d3d8dc; } Extraction richness neutral phylogenetic DREX1 53.69565 24.45051 4.093443 DREX2 53.45455 25.65059 4.011921 ZYMO 78.76190 35.06459 4.747699 alpha_data &lt;- alpha_diversity %&gt;% left_join(all_data,by= join_by(dataset==dataset)) alpha_data %&gt;% dplyr::select(dataset,Library,Species,Taxon,Sample,Extraction, richness,neutral,phylogenetic) %&gt;% pivot_longer(!c(dataset,Library,Species,Taxon,Sample,Extraction), names_to = &quot;metric&quot;, values_to = &quot;value&quot;) %&gt;% mutate(metric=factor(metric,levels=c(&quot;richness&quot;,&quot;neutral&quot;,&quot;phylogenetic&quot;))) %&gt;% mutate(Taxon=factor(Taxon,levels=c(&quot;Amphibian&quot;,&quot;Reptile&quot;,&quot;Mammal&quot;))) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction,y=value, color=Species, group=Extraction)) + geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(metric ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Diversity&quot;,x=&quot;Extraction method&quot;) 5.2.3 Richness alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, richness, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(log(richness) ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% plot() alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, richness, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(log(richness) ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 1.11973 0.37324 3 7.3165 8.2212 0.009737 ** Extraction 0.00066 0.00066 1 18.1552 0.0145 0.905457 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, richness, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(log(richness) ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.5630779 0.9814879 ## 2% of the variance explained by fixed effects ## 91% of the variance explained by random effects alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, richness, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(log(richness) ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% VarCorr() %&gt;% print(comp = &quot;Variance&quot;) Groups Name Variance Sample:Species (Intercept) 0.43244 Species (Intercept) 0.59370 Residual 0.04540 # Within-taxon between-species variance: 59% 91 * (0.85583 / (0.85583 + 0.47587)) [1] 58.48204 # Within-species between-sample variance: 33% 91 * (0.47587 / (0.47587 + 0.85583)) [1] 32.51796 REF got slightly lower richness values than DREX and EHEX. Large variability between species within taxa. 5.2.4 Neutral alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, neutral, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(neutral ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% plot() alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, neutral, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(neutral ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 88.276 29.425 3 8.1713 3.7932 0.05723 . Extraction 13.927 13.927 1 18.2611 1.7953 0.19672 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, neutral, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(neutral ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.4184782 0.9824999 ## 2% of the variance explained by fixed effects ## 91% of the variance explained by random effects alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, neutral, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(neutral ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% VarCorr() %&gt;% print(comp = &quot;Variance&quot;) Groups Name Variance Sample:Species (Intercept) 72.2871 Species (Intercept) 177.7304 Residual 7.7574 # Within-taxon between-species variance: 69% 89 * (286.830 / (286.830 + 81.267)) [1] 69.35093 # Within-species between-sample variance: 20% 89 * (81.267 / (286.830 + 81.267)) [1] 19.64907 No significant differences in neutral diversity between extraction methods and taxonomic groups. Neutral diversity very species specific. 5.2.5 Phylogenetic alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, phylogenetic, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(phylogenetic ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% plot() alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, phylogenetic, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(phylogenetic ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% anova() Type III Analysis of Variance Table with Satterthwaite&#39;s method Sum Sq Mean Sq NumDF DenDF F value Pr(&gt;F) Taxon 0.138785 0.046262 3 7.3192 8.3624 0.009285 ** Extraction 0.005187 0.005187 1 18.0146 0.9377 0.345697 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, phylogenetic, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(phylogenetic ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% r.squaredGLMM() R2m R2c [1,] 0.4943116 0.9985336 ## 6% of the variance explained by fixed effects ## 90% of the variance explained by random effects alpha_data %&gt;% dplyr::select(dataset, Extraction, Sample, Species, phylogenetic, Taxon, catalogue) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% lmerTest::lmer(phylogenetic ~ Taxon + Extraction + (1 | Species / Sample), data = ., REML = TRUE) %&gt;% VarCorr() %&gt;% print(comp = &quot;Variance&quot;) Groups Name Variance Sample:Species (Intercept) 1.8431440 Species (Intercept) 0.0590871 Residual 0.0055321 # Within-taxon between-species variance: 43% 90 * (1.37930 / (1.37930 + 1.51968)) [1] 42.82092 # Within-species between-sample variance: 47% 90 * (1.51968 / (1.37930 + 1.51968)) [1] 47.17908 No significant differences in phylogenetic diversity between extraction methods and taxonomic groups. 5.3 Microbial complexity recovery all_data %&gt;% select(dataset,Extraction,microbial_fraction,MAG_mapping_percentage,Taxon,catalogue) %&gt;% mutate(damr=pmin(1,MAG_mapping_percentage/(microbial_fraction))) %&gt;% mutate(damr=ifelse(is.na(damr),0,damr)) %&gt;% unique() %&gt;% # what do we filter for? group_by(Taxon,Extraction) %&gt;% summarise(value = sprintf(&quot;%.3f±%.3f&quot;, mean(damr), sd(damr))) %&gt;% pivot_wider(names_from = Extraction, values_from = value) %&gt;% tt(caption = &quot;Mean and standard deviation of breadth of host genome coverage&quot;) .table td.tinytable_css_id99zni4vkfusti98hcjot, .table th.tinytable_css_id99zni4vkfusti98hcjot { border-bottom: solid 0.1em #d3d8dc; } Mean and standard deviation of breadth of host genome coverage Taxon DREX1 DREX2 NA Amphibian 0.735±0.337 0.755±0.335 0.755±0.346 Reptile 0.970±0.054 0.977±0.044 0.947±0.070 Mammal 0.889±0.165 0.831±0.154 0.768±0.144 Bird 0.793±0.261 0.724±0.319 0.856±0.197 Control 1.000±0.000 1.000±0.000 1.000±0.000 all_data %&gt;% select(dataset,Extraction,microbial_fraction,MAG_mapping_percentage,Taxon,Sample,Species) %&gt;% mutate(damr=pmin(1,MAG_mapping_percentage/(microbial_fraction))) %&gt;% mutate(damr=ifelse(is.na(damr),0,damr)) %&gt;% unique() %&gt;% ggplot(aes(x=Extraction,y=damr, color=Species, group=Extraction)) + geom_boxplot(outlier.shape = NA, fill=&quot;#f4f4f4&quot;, color=&quot;#8c8c8c&quot;) + geom_jitter() + scale_color_manual(values=vertebrate_colors) + facet_grid(. ~ Taxon, scales = &quot;free&quot;) + theme_minimal() + labs(y=&quot;Domain-adjusted mapping rate&quot;,x=&quot;Extraction method&quot;) all_data %&gt;% select(dataset,Extraction,microbial_fraction,MAG_mapping_percentage,Taxon, Sample, Species,catalogue) %&gt;% mutate(damr=pmin(1,MAG_mapping_percentage/(microbial_fraction))) %&gt;% mutate(damr=ifelse(is.na(damr),0,damr)) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% MASS::glmmPQL(damr~ Taxon+Extraction,random=~1|Species/Sample, family=&quot;quasibinomial&quot;,data=.) %&gt;% car::Anova(.,test.statistic=&quot;Wald&quot;) Analysis of Deviance Table (Type II tests) Response: zz Chisq Df Pr(&gt;Chisq) Taxon 7.3087 3 0.06268 . Extraction 0.8126 1 0.36735 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 data&lt;-all_data %&gt;% select(dataset,Extraction,microbial_fraction,MAG_mapping_percentage,Taxon, Sample, Species,catalogue) %&gt;% mutate(damr=pmin(1,MAG_mapping_percentage/(microbial_fraction))) %&gt;% mutate(damr=ifelse(is.na(damr),0,damr)) %&gt;% unique() %&gt;% filter(Taxon != &quot;Control&quot;) M&lt;-MASS::glmmPQL(damr~ Taxon+Extraction,random=~1|Species/Sample, family=&quot;quasibinomial&quot;,data=data) Anova_table&lt;-car::Anova(M,test.statistic=&quot;Wald&quot;,type=&quot;III&quot;)%&gt;% mutate(F=Chisq/Df) # Approximate F value n &lt;- nrow(M$data) # Total number of observations df_fixed &lt;- length(fixef(M)) # Number of fixed effect parameters df_random &lt;- length(ranef(M)) # Number of random effect parameters (or levels) approx_residual_df &lt;- n - df_fixed - df_random # Approx. residual Df data.frame(Anova_table, p_value=pf(Anova_table$F, Anova_table$Df, approx_residual_df, lower.tail = FALSE))%&gt;% select(F,p_value) F p_value (Intercept) 5.3390824 0.02595890 Taxon 2.4362307 0.07835575 Extraction 0.8126216 0.37261149 broom.mixed::tidy(M) %&gt;% tt() .table td.tinytable_css_idllwrunk4msn1l1m94b9k, .table th.tinytable_css_idllwrunk4msn1l1m94b9k { border-bottom: solid 0.1em #d3d8dc; } effect term estimate std.error df statistic p.value fixed (Intercept) 1.4387361 0.6578611 23 2.1869906 0.03917178 fixed TaxonReptile 2.6143659 1.0908128 8 2.3967137 0.04339873 fixed TaxonMammal 0.8375006 0.9233536 8 0.9070205 0.39089766 fixed TaxonBird 0.1942911 0.9081699 8 0.2139369 0.83594824 fixed ExtractionDREX2 -0.2466398 0.2890715 23 -0.8532136 0.40233932 plot_model(M,type=&quot;pred&quot;,terms=c(&quot;Taxon&quot;,&quot;Extraction&quot;)) ## 27% of the variance explained by fixed effects ## 27% of the variance explained by random effects VarCorr(M) Variance StdDev Species = pdLogChol(1) (Intercept) 1.641071e-08 0.0001281043 Sample = pdLogChol(1) (Intercept) 1.783793e+00 1.3355873146 Residual 9.030113e-02 0.3005014586 # Within-taxon between-species variance: 0% 27*(2.545883e-08/(2.545883e-08+1.911908e+00)) [1] 3.595301e-07 # Within-species between-sample variance: 27% 27*(1.911908e+00/(2.545883e-08+1.911908e+00)) [1] 27 All three extraction methods yield similar DAMRs. 5.3.1 Community barplot # Retrieve EHI taxonomy colors phylum_colors &lt;- read_tsv(&quot;https://raw.githubusercontent.com/earthhologenome/EHI_taxonomy_colour/main/ehi_phylum_colors.tsv&quot;) %&gt;% right_join(genome_metadata, by=join_by(phylum == phylum)) %&gt;% select(phylum, colors) %&gt;% unique() %&gt;% arrange(phylum) %&gt;% select(colors) %&gt;% pull() # Stacked barplot genome_counts %&gt;% mutate_at(vars(-genome), funs(./sum(., na.rm = TRUE))) %&gt;% #apply TSS nornalisation pivot_longer(-genome, names_to = &quot;dataset&quot;, values_to = &quot;count&quot;) %&gt;% left_join(., genome_metadata, by = join_by(genome == genome)) %&gt;% #append taxonomy left_join(., sample_metadata, by = join_by(dataset == dataset)) %&gt;% mutate(Taxon=factor(Taxon,levels=c(&quot;Amphibian&quot;, &quot;Reptile&quot;, &quot;Mammal&quot;, &quot;Bird&quot;, &quot;Control&quot;))) %&gt;% mutate(Species=factor(Species,levels=c(&quot;Calotriton asper&quot;, &quot;Lissotriton helveticus&quot;, &quot;Salamandra atra&quot;, &quot;Chalcides striatus&quot;, &quot;Natrix astreptophora&quot;, &quot;Podarcis muralis&quot;, &quot;Plecotus auritus&quot;, &quot;Sciurus carolinensis&quot;, &quot;Trichosurus vulpecula&quot;, &quot;Geospizopsis unicolor&quot;, &quot;Perisoreus infaustus&quot;, &quot;Zonotrichia capensis&quot;, &quot;Extraction control&quot;, &quot;Library control&quot;))) %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% ggplot(., aes(x=dataset,y=count,fill=phylum, group=phylum))+ #grouping enables keeping the same sorting of taxonomic units geom_bar(stat=&quot;identity&quot;, colour=&quot;white&quot;, linewidth=0.1)+ #plot stacked bars with white borders scale_fill_manual(values=phylum_colors) + labs(y = &quot;Relative abundance&quot;) + facet_nested(. ~ Taxon + Species + Sample + Extraction, scales=&quot;free_x&quot;) + guides(fill = guide_legend(ncol = 3)) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), axis.title.x = element_blank(), panel.background = element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(linewidth = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.title=element_blank(), panel.spacing = unit(0, &quot;lines&quot;)) #ggsave(paste0(&quot;figures/barplot_&quot;,genus,&quot;.pdf&quot;)) genome_counts_filt_variance &lt;- genome_counts_filt %&gt;% column_to_rownames(var=&quot;genome&quot;) %&gt;% select(all_of(sample_metadata %&gt;% filter(!Taxon %in% c(&quot;Birds&quot;, &quot;Control&quot;)) %&gt;% # exclude birds pull(dataset))) %&gt;% select(where(~!all(. == 0))) # Perform betadisper analysis richness_betadisper_result &lt;- genome_counts_filt_variance %&gt;% hillpair(.,q=0, metric=&quot;C&quot;) %&gt;% as.dist() %&gt;% betadisper(., sample_metadata %&gt;% filter(dataset %in% colnames(genome_counts_filt_variance)) %&gt;% arrange(match(dataset,colnames(genome_counts_filt_variance))) %&gt;% pull(Extraction)) # Check if there are significant differences in dispersion permutest(richness_betadisper_result,pairwise = TRUE) # Tests homogeneity of dispersion and pairwise comparisons between groups using permutations. Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.009035 0.0045175 1.1444 999 0.326 Residuals 60 0.236859 0.0039477 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) DREX1 DREX2 ZYMO DREX1 0.56500 0.199 DREX2 0.55115 0.334 ZYMO 0.20658 0.35323 TukeyHSD(richness_betadisper_result) # test significance between each group Tukey multiple comparisons of means 95% family-wise confidence level Fit: aov(formula = distances ~ group, data = df) $group diff lwr upr p adj DREX2-DREX1 -0.007193598 -0.05379165 0.03940445 0.9270330 ZYMO-DREX1 -0.028224995 -0.07482304 0.01837305 0.3194398 ZYMO-DREX2 -0.021031398 -0.06762945 0.02556665 0.5272157 richness &lt;- genome_counts_filt_variance %&gt;% hillpair(.,q=0, metric=&quot;C&quot;) %&gt;% as.dist() %&gt;% # nrow(richness) adonis2(formula = . ~ Extraction+Taxon+Species+Sample, data = sample_metadata %&gt;% filter(dataset %in% colnames(genome_counts_filt_variance)) %&gt;% arrange(match(dataset,colnames(genome_counts_filt_variance))), permutations = 999, by=&quot;terms&quot;) %&gt;% broom::tidy() richness # A tibble: 6 × 6 term df SumOfSqs R2 statistic p.value &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 Extraction 2 0.575 0.0208 3.62 0.001 2 Taxon 3 6.62 0.239 27.7 0.001 3 Species 8 13.2 0.475 20.7 0.001 4 Sample 11 4.31 0.156 4.93 0.001 5 Residual 38 3.02 0.109 NA NA 6 Total 62 27.7 1 NA NA # Perform betadisper analysis neutral_betadisper_result &lt;- genome_counts_filt_variance %&gt;% hillpair(.,q=1, metric=&quot;C&quot;) %&gt;% as.dist() %&gt;% betadisper(., sample_metadata %&gt;% filter(dataset %in% colnames(genome_counts_filt_variance)) %&gt;% arrange(match(dataset,colnames(genome_counts_filt_variance))) %&gt;% pull(Extraction)) # Check if there are significant differences in dispersion permutest(neutral_betadisper_result,pairwise=TRUE) # Tests homogeneity of dispersion and pairwise comparisons between groups using permutations. Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.009171 0.0045854 1.3738 999 0.244 Residuals 60 0.200261 0.0033377 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) DREX1 DREX2 ZYMO DREX1 0.42800 0.170 DREX2 0.42982 0.314 ZYMO 0.16936 0.32804 neutral &lt;- genome_counts_filt_variance %&gt;% hillpair(.,q=1, metric=&quot;C&quot;) %&gt;% as.dist() %&gt;% adonis2(formula = . ~ Extraction+Taxon+Species+Sample, data = sample_metadata %&gt;% filter(dataset %in% colnames(genome_counts_filt_variance)) %&gt;% arrange(match(dataset,colnames(genome_counts_filt_variance))), permutations = 999, by=&quot;terms&quot;) %&gt;% broom::tidy() neutral # A tibble: 6 × 6 term df SumOfSqs R2 statistic p.value &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 Extraction 2 0.447 0.0160 5.29 0.001 2 Taxon 3 6.83 0.244 53.9 0.001 3 Species 8 13.4 0.479 39.7 0.001 4 Sample 11 5.68 0.203 12.2 0.001 5 Residual 38 1.61 0.0574 NA NA 6 Total 62 28.0 1 NA NA # Perform betadisper analysis phylogenetic_betadisper_result &lt;- genome_counts_filt_variance %&gt;% hillpair(.,q=1, metric=&quot;C&quot;) %&gt;% as.dist() %&gt;% betadisper(., sample_metadata %&gt;% filter(dataset %in% colnames(genome_counts_filt_variance)) %&gt;% arrange(match(dataset,colnames(genome_counts_filt_variance))) %&gt;% pull(Extraction)) # Check if there are significant differences in dispersion permutest(phylogenetic_betadisper_result,pairwise = TRUE) # Tests homogeneity of dispersion and pairwise comparisons between groups using permutations. Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 2 0.009171 0.0045854 1.3738 999 0.252 Residuals 60 0.200261 0.0033377 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) DREX1 DREX2 ZYMO DREX1 0.41300 0.180 DREX2 0.42982 0.348 ZYMO 0.16936 0.32804 phylogenetic &lt;- genome_counts_filt_variance %&gt;% hillpair(.,q=1, tree=genome_tree, metric=&quot;C&quot;) %&gt;% as.dist() %&gt;% adonis2(formula = . ~ Extraction+Taxon+Species+Sample, data = sample_metadata %&gt;% filter(dataset %in% colnames(genome_counts_filt_variance)) %&gt;% arrange(match(dataset,colnames(genome_counts_filt_variance))), permutations = 999, by=&quot;terms&quot;) %&gt;% broom::tidy() phylogenetic # A tibble: 6 × 6 term df SumOfSqs R2 statistic p.value &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 Extraction 2 0.259 0.0259 4.96 0.001 2 Taxon 3 3.63 0.364 46.4 0.001 3 Species 8 3.67 0.368 17.6 0.001 4 Sample 11 1.41 0.142 4.93 0.001 5 Residual 38 0.991 0.0994 NA NA 6 Total 62 9.97 1 NA NA data.frame( Term = factor(rep(c(&quot;Extraction&quot;, &quot;Taxon&quot;, &quot;Species&quot;,&quot;Sample&quot;,&quot;Residual&quot;), times = 3),levels = c(&quot;Extraction&quot;, &quot;Taxon&quot;, &quot;Species&quot;,&quot;Sample&quot;,&quot;Residual&quot;)), Metric = factor(rep(c(&quot;Richness&quot;, &quot;Neutral&quot;, &quot;Phylogenetic&quot;), each = 5),levels = c(&quot;Richness&quot;, &quot;Neutral&quot;, &quot;Phylogenetic&quot;)), Value = c(richness$R2[-6],neutral$R2[-6],phylogenetic$R2[-6]) )%&gt;% ggplot(., aes(x = Metric, y = Value, fill = Term)) + geom_bar(stat = &quot;identity&quot;, position = &quot;stack&quot;) + #scale_fill_brewer(palette = &quot;Set1&quot;) + # Choose a color palette scale_fill_manual(values = c(&quot;#47bfb6&quot;, &quot;#4a7015&quot;, &quot;#5e1717&quot;, &quot;#9e6b24&quot;, &quot;#4a4a4a&quot;)) + labs( x = &quot;Beta diversity metric&quot;, y = &quot;R-square&quot;, fill = &quot;Term&quot; ) + theme_minimal() genome_counts_NMDS &lt;- genome_counts_filt_variance %&gt;% #column_to_rownames(var=&quot;genome&quot;) %&gt;% select(where(~!all(. == 0))) %&gt;% hillpair(.,q=1, metric=&quot;C&quot;, out=&quot;dist&quot;) %&gt;% metaMDS(.,trymax = 999, k=2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;dataset&quot;) %&gt;% left_join(sample_metadata, by = join_by(dataset == dataset)) %&gt;% filter(Taxon != &quot;Control&quot;) %&gt;% group_by(Sample) %&gt;% mutate(sample_x=mean(NMDS1), sample_y=mean(NMDS2)) genome_counts_NMDS %&gt;% ggplot(., aes(x=NMDS1,y=NMDS2, color=Species, shape=Extraction)) + scale_color_manual(values=vertebrate_colors) + geom_point(size=3, alpha=0.8) + geom_segment(aes(x=sample_x, y=sample_y, xend=NMDS1, yend=NMDS2), alpha=0.2) + theme_classic() + theme(legend.position=&quot;right&quot;, legend.box=&quot;vertical&quot;) + guides(color=guide_legend(title=&quot;Species&quot;)) "],["sample-digestion.html", "6 Sample homogeneisation and digestion 6.1 Instruments, plasticware and reagents 6.2 Protocol", " 6 Sample homogeneisation and digestion Homogenisation and digestion of biological samples like faeces or intestinal contents are crucial steps in the process of DNA extraction. These steps help break down the complex matrix of the sample, thus separating different compounds and molecules from each other. Faeces, for example, are composed of a heterogeneous mixture of materials, including undigested food, microbial cells, host cells, and waste products. This complex matrix can make it challenging to access and extract DNA. Homogenisation involves breaking down the solid and semi-solid components of the sample, creating a more uniform mixture that is easier to work with, while digestion also entails degrading cellular structures to release intracellular compounds to the matrix. The EHI samples are stored in a buffer that serves a dual purpose as both a preservative and a digestion buffer. The buffer facilitates the release of nucleic acids from cells and tissues through breaking down cellular membranes and structures. The EHI protocol also includes bead-beating using a combination of ceramic, silica and glass beads for sample homogenisation. The mechanical force generated by the beads’ movement and collision with the sample causes physical disruption, breaking apart cells and releasing their contents into the surrounding solution. Optimisation of bead-beating conditions is necessary to balance efficient disruption with minimal degradation, as depending on the sample, bead types, and shearing time, there is a potential risk of shearing or damaging sensitive biomolecules. 6.1 Instruments, plasticware and reagents Instruments Bead mill/beater homogenizer e.g. TissueLyser II (Qiagen) Analytical balance (for tissue sample) Block Heater-Shaker e.g. ThermoMixer C (Eppendorf) (for tissue sample) SAFE® Screw Cap De-/Capper (LVL technologies) SAFE® 2D/1D Code Reader (LVL technologies) Plasticware Item Brand Catalogue number Lysing Matrix E 96-Well Plate MP Biomedicals 116984001-CF Polystyrene Tweezer (Single packed disposable sterile) Megro Carbon steel surgical scalpel blades (Single packed sterile) 1C-X10-BL-CW-B-S LX 1000 - 2D Biobanking Tubes LVL technologies 1C-X10-BL-CW-B-S Reagents Reagent | Brand | Catalogue number | Storage | UltraPure™ 1M Tris Hydrochloride, Tris-HCI | Invitrogen | 15568025 | 4 ºC | UltraPure™ 0.5M Ethylenediaminetetraacetic acid, EDTA | Invitrogen | 15575-038 | 25 ºC | BioUltra Sodium dodecyl sulfate solution, SDS | Sigma Aldrich | 71736 | 25 ºC | Proteinase K 20 mg/ml | Roche | 3115828001 | 4 ºC | 6.2 Protocol Faeces and swabs Thaw the samples and ensure samples have entirely thawed. Spin down or gently centrifuge tubes briefly to remove any liquid from the lid. Add the content of 1 well of the Lysing Matrix E 96-Well Plate to each collection tube. Vortex to ensure that the beads are moving in each sample. If beads are not moving despite vortexing, it is an indication of overstuffing the sample. Consider using a sterile pipet tip to attempt unclogging the beads. Homogenise the sample with the TissueLyser for two rounds of 6 minutes at max speed (=30 Hz). Spin down or centrifuge the tubes at 2,2 g/rcf for 1 minute. Ensure no foam is present on the tube’s lids. Otherwise, repeat centrifugation. Gently transfer the supernatant to an LX 1000 LVL tube without disturbing the pellet+beads. Tissue samples Extract the tissue from the original preservation tube, dry it out and weight it on a sterile weighing boat. If the tissue sample is heavier than 10 mg, cut a portion using a sterile scalpel and place it in an Eppendorf tube Add 250 μl of SDS lysis buffer solution to the tube and 25 μl of proteinase K. Incubation overnight at 56°C on a a thermoshaker. Centrifuge/Spin Down** the tubes at 2,2 g/rcf for 1 minutes. Ensure no foam is present on the tube’s lids. Otherwise, repeat centrifugation. Transfer the digested sample to an LX 1000 LVL tube. "],["Zymo-dna-extraction.html", "7 ZYMO DNA extraction 7.1 Instruments, plasticware and reagents 7.2 Protocol", " 7 ZYMO DNA extraction DNA extraction involves isolating DNA molecules from the rest of organic materials in the mixture, as well as removing inhibitors such as polysaccharides, proteins and bile salts, which can affect downstream enzymatic reactions, such as adaptor ligation or PCR amplification. The DNA extraction procedure employed in the EHI involves DNA isolation using silica magnetic beads combined with solid-phase reversible immobilisation (SPRI) to remove as many inhibitors as possible. This technique takes advantage of the binding properties of silica magnetic beads to selectively capture DNA fragments, followed by the principle of SPRI to efficiently remove impurities and elute the purified DNA. 7.1 Instruments, plasticware and reagents Instruments Block Heater-Shaker such as ThermoMixer C (Eppendorf) (for tissue sample) Magnet compatible with V-Bottom 96-well plates such as Magnum™ EX Universal 96-well Magnet Plate (Alpaca, SKU: A000380) Fluorometer such as Qubit Flex Fluorometer (Invitrogen) SAFE® Screw Cap De-/Capper (LVL technologies) SAFE® 2D/1D Code Reader (LVL technologies) Plasticware Item Brand Catalogue number 96-well V-shaped 1ml microplate 4titude 4ti-0125 XSX 200 - 2D Biobanking Tubes LVL technologies 1C-X02-BL-CW-B-L Self-adhesive aluminium foil LVL technologies AF100Plus Thin-walled polypropylene tubes with very low fluorescence compatible with Fluorometer such as Qubit Flex Assay Tube Strips Invitrogen Q33252 Stock reagents Reagent Brand Catalogue number Storage Deionized ultrapure water (ddH2O) Bionordika BN-51100 25 ºC ZymoBIOMICS MagBead DNA/RNA Zymo Research R2135/R2136 25 ºC Qubit DNA HS Assay Kit Invitrogen Q32851 4 ºC Qubit DNA BR Assay Kit Invitrogen Q32850 4 ºC 7.2 Protocol Total Nucleic Acid Purification Add 200 µl (1 volume) DNA/RNA Lysis Buffer to 200 µl sample and mix well. Add 400 µl ethanol (95-100%) to the sample and mix well. Add 30 µl ZymoBIOMICS™ MagBinding Beads* and mix well for 20 minutes (21ºC, 1000 rpm). *ZymoBIOMICS™ MagBinding Beads settle quickly, ensure that beads are kept in suspension while dispensing. Transfer the plate/tube to the magnetic stand2 until beads have pelleted, then aspirate and discard the cleared supernatant. Add 500 µl MagBead DNA/RNA Wash 1 and mix well. Pellet the beads and discard the supernatant. Add 500 µl MagBead DNA/RNA Wash 2 and mix well. Pellet the beads and discard the supernatant. Add 500 µl ethanol (95-100%) and mix well. Pellet the beads and discard the supernatant. Repeat step 7. Dry the beads for 10 minutes or until dry. To elute DNA/RNA from the beads, add 50 µl ZymoBIOMICS™ DNase/RNase-Free Water and mix well for 5 minutes. Transfer the plate/tube to the magnetic stand until beads have pelleted, then aspirate and dispense the eluted DNA/RNA to a new plate/tube. The eluted DNA/RNA can be used immediately or stored frozen. Use 2 µl to selectively quantify DNA using the Qubit DNA HS or BR Assay Kit and a Qubit Fluorometer. Place the plate on the magnetic rack. Transfer the Nucleic Acid extract to a 200 µl LVL tube. Store the 200 µl LVL tube plate at -80ºC until further processing. "],["drex-dna-extraction.html", "8 DREX DNA extraction 8.1 Instruments, plasticware and reagents 8.2 Preparation of working reagents 8.3 Protocol", " 8 DREX DNA extraction DNA extraction involves isolating DNA molecules from the rest of organic materials in the mixture, as well as removing inhibitors such as polysaccharides, proteins and bile salts, which can affect downstream enzymatic reactions, such as adaptor ligation or PCR amplification. The DNA extraction procedure employed in the EHI involves DNA isolation using silica magnetic beads combined with solid-phase reversible immobilisation (SPRI) to remove as many inhibitors as possible. This technique takes advantage of the binding properties of silica magnetic beads to selectively capture DNA fragments, followed by the principle of SPRI to efficiently remove impurities and elute the purified DNA. 8.1 Instruments, plasticware and reagents Instruments Block Heater-Shaker such as ThermoMixer C (Eppendorf) (for tissue sample) Magnet compatible with V-Bottom 96-well plates such as Magnum™ EX Universal 96-well Magnet Plate (Alpaca, SKU: A000380) Fluorometer such as Qubit Flex Fluorometer (Invitrogen) SAFE® Screw Cap De-/Capper (LVL technologies) SAFE® 2D/1D Code Reader (LVL technologies) Plasticware Item Brand Catalogue number Millex-GP 0.22 µm Syringe Filter Millipore SLGV013SL Syringe (Single packed disposable sterile) 96-well V-shaped 1ml microplate 4titude 4ti-0125 XSX 200 - 2D Biobanking Tubes LVL technologies 1C-X02-BL-CW-B-L Self-adhesive aluminium foil LVL technologies AF100Plus Thin-walled polypropylene tubes with very low fluorescence compatible with Fluorometer such as Qubit Flex Assay Tube Strips Invitrogen Q33252 Stock reagents Reagent Brand Catalogue number Storage Deionized ultrapure water (ddH2O) Bionordika BN-51100 25 ºC Absolute ethanol, EtOH 25 ºC BioUltra Citric acid Sigma-Aldrich 27487 25 ºC BioUltra Citrate Concentrate Solution (1M) Sigma-Aldrich 83273-250ML-F 25 ºC Guanidine thiocyanate (GuSCN) Sigma-Aldrich G9277 25 ºC N-Lauroylsarcosine sodium salt solution Sigma-Aldrich L7414-50ML RT BioReagent 2-Isopropanol  Sigma-Aldrich I9516-500ML 25 ºC Hydrochloric acid solution (1M), HCl Sigma-Aldrich 25 ºC BioUltra Sodium Hydroxide solution (10M), NaOH Sigma-Aldrich 72068-100ML 25 ºC TWEEN® 20 Sigma-Aldrich P9416-50ML 25 ºC Silica magnetic beads G-Biosciences 786-916 4ºC Elution Buffer (EB) Qiagen 19086 25 ºC Qubit DNA HS Assay Kit Invitrogen Q32851 4 ºC Qubit DNA BR Assay Kit Invitrogen Q32850 4 ºC 8.2 Preparation of working reagents Citrate buffer (0.1 M, ph 5.0) To prepare a stock of 50ml: In a 50 mL centrifuge tube, prepare Citric acid stock solution (1 M) by dissolving 9.60 g of citric acid powder (molecular weight = 192.12 g/mol) in H2O to a final volume of 50 mL. In a 50 mL centrifuge tube, dilute Citric acid stock solution 1:10 to reach a 0.1 M solution with H2O. In a 50 mL centrifuge tube, dilute Trisodium citrate/Citrate Concentrate solution (1 M) 1:10 to reach a 0.1 M solution with H2O. In a 50 mL centrifuge tube, combine 17.5 mL of Citric acid solution (0.1 M) with 32.5 mL of Trisodium citrate/Citrate Concentrate solution (0.1 M). Check that pH is around 5.0 and adjust if needed using NAOH (10M). Buffer B To prepare a stock of 50ml: Weigh 29.54 g of Guanidine thiocyanate (GuSCN) using a large weighing boat. Add the GuSCN to a sterile PC or glass bottle (150 mL). Add 20 mL H2O, 5 mL of Citrate buffer (0.1 M) and a sterile stirring bar. Place the solution (approximately 45 mL) on the magnetic stirrer to dissolve completely. Add 2.5 mL of N-Lauroylsarcosine sodium salt solution (20%, pH 7-9). Add H2O to a final volume of 50 mL. Filter with a 0.22 µm Syringe Filter. Check that pH is around 5.0 and adjust if needed using NAOH (10M). Buffer C - DNA fraction To prepare a stock of 50ml: Weigh 11.82 g of Guanidine thiocyanate (GuSCN) using a large weighing boat. Add the GuSCN to a sterile PC or glass bottle (150 mL). Add 5 mL H2O, 5 mL of Citrate buffer (0.1 M) and a sterile stirring bar. Place the solution on the magnetic stirrer to dissolve completely. Add 30 mL of Isopropanol (2-Propanol). Add 25 µl of Tween20. Filter with a 0.22 µm Syringe Filter. Filter slowly to avoid filter overflowing. Check that pH is around 5.0 and adjust if needed using NAOH (10M). EBT buffer To prepare a stock of 50ml: In a 50 mL centrifuge tube, mix 50 ml of EB buffer with 25 µl of Tween20. Silica magnetic beads and buffer aliquots Switch on the Thermo Mixer and set to 15 minutes, 10 C, 1500 rpm [See ‘Protocol’ step 5]. Equilibrate* the silica magnetic beads to room temperature for 30 min. Create the aliquots of reagents needed according to the table below. Prepare reagents for around 10% overage samples. Ensure that beads are thoroughly resuspended before taking an aliquot. Working reagent Volume per sample Beads - DNA fraction 15 µl Buffer B 200 µl Buffer C - DNA fraction 200 µl 80% EtOH - DNA washing 400 µl Place the tube containing silica beads on a magnetic rack and wait until the beads are immobilised on the wall, and the supernatant is clear. Discard the clear supernatant. Add 2 mL of Tris-EDTA (TE) buffer to the tube. The TE buffer volume may be reduced according to the volume of the beads needed. The beads must be submerged during the wash step. Discard the supernatant. Repeat steps 6 and 7. Transfer “Beads - DNA fraction” to Buffer B. Mix well (by vortexing if you can avoid bubbles) the mixture “Beads - Buffer B”. *Store the silica magnetic beads (G-Biosciences) at 4°C. Do not freeze the silica magnetic beads (G-Biosciences) or store them near a magnetic source. 8.3 Protocol Ensure that the mixture “Beads - Buffer B” is properly mixed. Transfer 200 µl of the mixture to each well of the Deep Well microplate. Ensure samples have entirely thawed. Vortex and centrifuge/spin down the LVL rack for 30 seconds to remove any liquid from the LVL tube lid. Transfer 200 μL of each sample to the Deep Well microplate (from now refered to DNA plate). Seal the DNA plate with a self-adhesive aluminium foil and spin down. Incubate DNA plate: for 15 minutes at 10ºC with shaking at 1500 rpm. Spin down shortly at 1000 g. Place the DNA plate on a magnetic rack and wait until the supernatant is clear. Discard the supernatant. Remove the DNA plate from the magnet. Add 200 µl of Buffer C to each well and mix well by pipetting. Cover the DNA plate with an aluminium seal and spin down shortly. Place the DNA plate on a magnetic rack and wait until the supernatant is clear. Discard the supernatant. Remove the DNA plate from the magnet. Add 200 µl of 80% EtOH and mix well by pipetting. Place the DNA plate on the magnetic rack and wait until the supernatant is clear. Discard the supernatant. Repeat step 9, briefly spin down the plate to bring EtOH residues down and repeat step 10. Ensure that all residual ethanol is removed. Dry the beads for at least 5 minutes. Remove the DNA plate from the magnet. Add 50 µl of EBT buffer. Cover the DNA plate with an aluminium seal and spin down shortly. Incubate DNA plate: 5 minutes at 25 ºC with shaking at 1500 rpm. Spin down the DNA plate shortly at 1000 g. Place the DNA plate on a magnetic rack and wait until the supernatant is clear. Aspirate slowly (to avoid bead transfer) and transfer the supernatant with eluted DNA to a new plate. Use 2 µl to selectively quantify DNA using the Qubit DNA HS or BR Assay Kit and a Qubit Fluorometer. Place the plate on a magnetic rack. Transfer the DNA extract to a 200 µl LVL tube. Store the 200 µl LVL tube plate at -20ºC until further processing. "],["ehex-dna-extraction.html", "9 EHEX DNA extraction 9.1 Instruments, plasticware and reagents 9.2 Preparation of working reagents 9.3 Protocol", " 9 EHEX DNA extraction DNA extraction involves isolating DNA molecules from the rest of organic materials in the mixture, as well as removing inhibitors such as polysaccharides, proteins and bile salts, which can affect downstream enzymatic reactions, such as adaptor ligation or PCR amplification. The DNA extraction procedure employed in the EHI involves DNA isolation using silica magnetic beads combined with solid-phase reversible immobilisation (SPRI) to remove as many inhibitors as possible. This technique takes advantage of the binding properties of silica magnetic beads to selectively capture DNA fragments, followed by the principle of SPRI to efficiently remove impurities and elute the purified DNA. 9.1 Instruments, plasticware and reagents Instruments Block Heater-Shaker such as ThermoMixer C (Eppendorf) (for tissue sample) Magnet compatible with V-Bottom 96-well plates such as Magnum™ EX Universal 96-well Magnet Plate (Alpaca, SKU: A000380) Fluorometer such as Qubit Flex Fluorometer (Invitrogen) SAFE® Screw Cap De-/Capper (LVL technologies) SAFE® 2D/1D Code Reader (LVL technologies) Plasticware Item Brand Catalogue number Millex-GP 0.22 µm Syringe Filter Millipore SLGV013SL Syringe (Single packed disposable sterile) 96-well V-shaped 1ml microplate 4titude 4ti-0125 XSX 200 - 2D Biobanking Tubes LVL technologies 1C-X02-BL-CW-B-L Self-adhesive aluminium foil LVL technologies AF100Plus Thin-walled polypropylene tubes with very low fluorescence compatible with Fluorometer such as Qubit Flex Assay Tube Strips Invitrogen Q33252 Stock reagents Reagent Brand Catalogue number Storage Deionized ultrapure water (ddH2O) Bionordika BN-51100 25 ºC Absolute ethanol, EtOH 25 ºC BioUltra Citric acid Sigma-Aldrich 27487 25 ºC BioUltra Citrate Concentrate Solution (1M) Sigma-Aldrich 83273-250ML-F 25 ºC Guanidine thiocyanate (GuSCN) Sigma-Aldrich G9277 25 ºC BioReagent 2-Isopropanol  Sigma-Aldrich I9516-500ML 25 ºC Hydrochloric acid solution (1M), HCl Sigma-Aldrich 25 ºC BioUltra Sodium Hydroxide solution (10M), NaOH Sigma-Aldrich 72068-100ML 25 ºC TWEEN® 20 Sigma-Aldrich P9416-50ML 25 ºC Silica magnetic beads G-Biosciences 786-916 4ºC Elution Buffer (EB) Qiagen 19086 25 ºC Qubit DNA HS Assay Kit Invitrogen Q32851 4 ºC Qubit DNA BR Assay Kit Invitrogen Q32850 4 ºC 9.2 Preparation of working reagents Citrate buffer (0.1 M, ph 5.0) To prepare a stock of 50ml: In a 50 mL centrifuge tube, prepare Citric acid stock solution (1 M) by dissolving 9.60 g of citric acid powder (molecular weight = 192.12 g/mol) in H2O to a final volume of 50 mL. In a 50 mL centrifuge tube, dilute Citric acid stock solution 1:10 to reach a 0.1 M solution with H2O. In a 50 mL centrifuge tube, dilute Trisodium citrate/Citrate Concentrate solution (1 M) 1:10 to reach a 0.1 M solution with H2O. In a 50 mL centrifuge tube, combine 17.5 mL of Citric acid solution (0.1 M) with 32.5 mL of Trisodium citrate/Citrate Concentrate solution (0.1 M). Check that pH is around 5.0 and adjust if needed using NAOH (10M). Buffer C - DNA fraction To prepare a stock of 50ml: Weigh 11.82 g of Guanidine thiocyanate (GuSCN) using a large weighing boat. Add the GuSCN to a sterile PC or glass bottle (150 mL). Add 5 mL H2O, 5 mL of Citrate buffer (0.1 M) and a sterile stirring bar. Place the solution on the magnetic stirrer to dissolve completely. Add 30 mL of Isopropanol (2-Propanol). Add 25 µl of Tween20. Filter with a 0.22 µm Syringe Filter. Filter slowly to avoid filter overflowing. Check that pH is around 5.0 and adjust if needed using NAOH (10M). EBT buffer To prepare a stock of 50ml: In a 50 mL centrifuge tube, mix 50 ml of EB buffer with 25 µl of Tween20. Silica magnetic beads and buffer aliquots Switch on the Thermo Mixer and set to 15 minutes, 10 C, 1500 rpm [See ‘Protocol’ step 5] Equilibrate* the silica magnetic beads to room temperature for 30 min. Create the aliquots of reagents needed according to the table below. Prepare reagents for around 10% overage samples. Ensure the beads are thoroughly resuspended before taking an aliquot. Working reagent Volume per sample Beads - DNA fraction 15 µl Buffer C 200 µl 80% EtOH - DNA washing 400 µl Place the tube containing silica beads on a magnetic rack and wait until the beads are immobilised on the wall, and the supernatant is clear. Discard the clear supernatant. Add 2 mL of Tris-EDTA (TE) buffer to the tube. The TE buffer volume may be reduced according to the volume of the beads needed. The beads must be submerged during the wash step. Discard the supernatant. Repeat steps 6 and 7. Transfer “Beads - DNA fraction” to Buffer C. Mix well by vortexing (avoid bubbles if possible)”. *Store the silica magnetic beads (G-Biosciences) at 4°C. Do not freeze the silica magnetic beads (G-Biosciences) or store them near a magnetic source. 9.3 Protocol Ensure that the mixture “Beads - Buffer B” is properly mixed. Transfer 200 µl of the mixture to each well of the Deep Well microplate. Ensure samples have entirely thawed. Vortex and centrifuge/spin down the LVL rack for 30 seconds to remove any liquid from the LVL tube lid. Transfer 200 μL of each sample to the Deep Well microplate (from now refered to DNA plate). Seal the DNA plate with a self-adhesive aluminium foil and spin down. Incubate DNA plate: for 15 minutes at 10ºC with shaking at 1500 rpm. Spin down at 1000 g. Place the DNA plate on a magnetic rack and wait until the supernatant is clear. Discard the supernatant. Remove the DNA plate from the magnet. Add 200 µl of 80% EtOH and mix well by pipetting. Place the DNA plate on the magnetic rack and wait until the supernatant is clear. Discard the supernatant. Repeat step 7, briefly spin down the plate to bring EtOH residues down and repeat step 8. Ensure that all residual ethanol is removed. Dry the beads for at least 5 minutes. Remove the DNA plate from the magnet. Add 50 µl of EBT buffer. Cover the DNA plate with an aluminium seal and spin down shortly. Incubate DNA plate: 5 minutes at 25 ºC with shaking at 1500 rpm. Spin down the DNA plate shortly at 1000 g. Place the DNA plate on a magnetic rack and wait until the supernatant is clear. Aspirate slowly (to avoid bead transfer) and transfer the supernatant with eluted DNA to a new plate. Use 2 µl to selectively quantify DNA using the Qubit DNA HS or BR Assay Kit and a Qubit Fluorometer. Place the plate on a magnetic rack. Transfer the DNA extract to a 200 µl LVL tube. Use 2 µl to selectively quantify DNA using the Qubit DNA HS or BR Assay Kit and a Qubit Fluorometer. Store the 200 µl LVL tube plate at -20ºC until further processing. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
